# Multi Echo Candy 使用说明

## 功能简介

当有人在群内发送 `类型/代号/费用` 格式的消息时，机器人会自动发送 `@发送者 费用`。  
每个机器人账号拥有独立的商品列表、白名单和延迟设置。

> 💡 商品代号在匹配时会按字符排序后比较，因此 `123` 与 `321` 视为同一代号。  
> 💡 当消息中的费用超过商品费用上限时，机器人会以上限值进行回复，而非忽略该消息。

---

## 快速上手

```text
1. 添加主人 123456789                   ← 添加管理员（超级管理员操作，可选）
2. 添加群 1234567890                   ← 将群加入白名单
3. 切换总开关                           ← 确认总开关已开启（仅首个连接的机器人生效）
4. 设置压车数 <123-200/456-400/...>   ← 设置商品目录
5. 设置下限 100                      ← 设置全局商品费用下限
6. 收2/123/200                      → 机器人 "@发送者 200"
```

> 💡 可随时用 `@机器人 查看状态` 查看当前配置。

---

## 权限说明

| 角色    | 来源                                                     | 能做什么                 |
|-------|--------------------------------------------------------|----------------------|
| 超级管理员 | `.env.multi_echo_candy` 中 `SUPERUSER` 配置的 QQ 号 / 机器人自身 | 全部权限，包括管理管理员         |
| 管理员   | 由超级管理员通过命令添加                                           | 白名单管理、跟随管理、查看状态、设置延迟 |

---

## 命令一览

### 管理员管理（仅超级管理员）

> 📌 在群内发送时，对该群内**所有在线的机器人**生效。

| 命令           | 说明    |
|--------------|-------|
| `添加主人 <QQ号>` | 添加管理员 |
| `删除主人 <QQ号>` | 删除管理员 |

### 群白名单管理

> 📌 在群内发送时，对该群内**所有在线的机器人**生效。

| 命令         | 说明      |
|------------|---------|
| `添加群 <群号>` | 将群加入白名单 |
| `删除群 <群号>` | 将群移出白名单 |

### 商品管理

> 📌 在群内发送时，对该群内**所有在线的机器人**生效。

| 命令                               | 说明              |
|----------------------------------|-----------------|
| `设置压车数 <代号-费用上限/代号-费用上限/...>`    | 设置商品目录          |
| `删除压车数 <代号-费用上限/代号-费用上限/...>`    | 删除商品目录          |
| `设置一包杀压车数 <代号-费用上限/代号-费用上限/...>` | 设置一包杀商品目录       |
| `删除一包杀压车数 <代号-费用上限/代号-费用上限/...>` | 删除一包杀商品目录       |
| `设置下限 <费用>`                      | 设置商品费用下限        |
| `清空商品`                           | 删除当前机器人的所有商品记录  |

### 开关与状态

| 命令             | 说明                          |
|----------------|-----------------------------|
| `切换总开关`        | 开启 / 关闭全局功能（仅首个连接的机器人生效）    |
| `@机器人 查看状态`    | 查看在线账号、本群开启状态               |
| `@机器人 查看当前添加群` | 查看白名单群列表                    |

### 延迟设置（需 @机器人）

| 命令               | 说明                |
|------------------|-------------------|
| `@机器人 设置延迟 <毫秒>` | 设置复读延迟（0~30000ms） |

---

## 消息发送条件

以下条件 **全部满足** 时，机器人才会回复：

1. ✅ 总开关已开启
2. ✅ 当前群在机器人白名单内
3. ✅ 消息格式为 `收2/代号/费用`（可追加 `一包杀` 后缀，如 `收2/123/200一包杀`）
4. ✅ 代号在商品目录中存在（匹配时按字符排序比较，如 `123` 与 `321` 视为同一代号）
5. ✅ 费用 ≥ 商品费用下限
6. 💡 若费用 > 商品费用上限，则以上限值回复

---

## 常见问题

| 问题                 | 原因                                               |
|--------------------|--------------------------------------------------|
| 发了 `类型/代号/费用` 没反应？ | 发送者的消息格式必须是由两个斜杠隔开，如 `类型/代号/费用`                  |
| 群加了跟随但不复读？         | 检查该群是否在白名单内，以及总开关是否开启                            |
| 换了个机器人号就不工作了？      | 白名单、商品列表、延迟都是**按机器人账号独立存储**的，检查设置商品时该机器人是否在群并且在线 |
| QQ号/群号提示不合法？       | 号码需为 6~13 位数字且不以 0 开头                            |
| 重复添加/删除会怎样？        | 正常返回成功/取消提示，不会报错                                 |
